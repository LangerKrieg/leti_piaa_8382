Code with comments:
https://ideone.com/oncIKU

