Code with comments:
https://ideone.com/y8wOWQ
